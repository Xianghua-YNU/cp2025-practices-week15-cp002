# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** 钱曼聆
**学号：** 20231050037
**完成日期：** 2025.6.4

## 1. 实验目的
本次实验旨在通过数值模拟理解在平方反比有心力场中粒子的运动规律，掌握不同能量条件下轨道类型（椭圆、抛物线、双曲线）的特征，并验证能量和角动量守恒。同时学习通过调整初始条件控制轨道形状的方法。

## 2. 核心算法与实现

### 2.1 运动方程与数值方法
（简要说明你所使用的运动方程（例如，直角坐标系下的二阶微分方程组）以及你选择的数值求解方法，如 `scipy.integrate.solve_ivp` 及其参数设置，或自行实现的算法如龙格-库塔法等。）
运动方程：
在直角坐标系下，采用牛顿第二定律和万有引力定律，建立二阶微分方程组：
![image](https://github.com/user-attachments/assets/d579de80-b667-4310-bc51-720b85a3bea2)
因为![image](https://github.com/user-attachments/assets/108cb206-25f8-48ea-a8e1-e4e3d9b5114d)，并降为一阶方程组。
![image](https://github.com/user-attachments/assets/543ed2bd-82da-4c9b-892c-09ed20c9ceff)

数值求解方法：
使用 scipy.integrate.solve_ivp 的 RK45（4-5阶龙格-库塔法），参数设置：
rtol=1e-7（相对误差容限）
atol=1e-9（绝对误差容限）
固定时间步长采样 t_eval 保证输出均匀，但实际计算采用自适应步长以提高效率。
该方法在保证精度的同时自动调整步长，适合处理轨道动力学中的高速近星点和低速远星点。

### 2.2 关键函数实现思路
（选择1-2个你认为最核心的函数，例如 `derivatives` 或 `solve_orbit`，用3-5句话描述其实现思路和关键步骤。）
#### `derivatives 函数` 实现思路：
1.解析力学关系：根据牛顿万有引力定律，加速度分量由![image](https://github.com/user-attachments/assets/deeb4ec5-4210-4779-a69c-784bf6339ffb)决定，其中![image](https://github.com/user-attachments/assets/82e45beb-3fd0-491f-9020-5fa9d4b2f2f0)。
2.降阶处理：将二阶运动方程拆解为一阶方程组，返回[vx,vy,ax,ay]
3.数值稳定性：对r^3接近零的情况（如碰撞）施加小阈值保护，避免除零错误。

```python
# 在此处粘贴你的核心代码片段 (5-10行)
# 例如 derivatives 函数的核心计算部分
def derivatives(t, state_vector, gm_val):
    x, y, vx, vy = state_vector
    r = np.sqrt(x**2 + y**2)
    r_cubed = r**3
    
    # 防止r过小导致的数值不稳定
    if r_cubed < 1e-12:
        r_cubed = 1e-12
    
    ax = -gm_val * x / r_cubed
    ay = -gm_val * y / r_cubed
    
    return [vx, vy, ax, ay]
```

#### `solve_orbit` 实现思路：
1.调用 solve_ivp：利用 RK45 自适应步长算法，动态调整积分步长以平衡精度与效率。
2.参数控制：通过 rtol 和 atol 调节误差容限，确保能量/角动量守恒性。
3.输出管理：固定 t_eval 时间点输出，便于后续分析和可视化，同时保留自适应计算的灵活性。

```python
# 在此处粘贴你的核心代码片段 (5-10行)
# 例如 solve_orbit 函数调用 solve_ivp 的部分
def solve_orbit(initial_conditions, t_span, t_eval, gm_val=GM):
    sol = solve_ivp(
        fun=derivatives,
        t_span=t_span,
        y0=initial_conditions,
        t_eval=t_eval,
        args=(gm_val,),
        method='RK45',
        rtol=1e-7,
        atol=1e-9
    )
    return sol
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

（在此处展示并分析你针对任务 A 生成的轨道图像。确保图像清晰，包含必要的标签和图例。）
Demonstrating orbital simulations...
Ellipse: Initial E = -0.680, Initial Lz = 0.800
Ellipse: Final E = -0.680, Final Lz = 0.800 (Energy/Ang. Mom. Conservation Check)
Parabola: Initial E = 0.000
Hyperbola: Initial E = 0.440

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**
![ee494273cd949b68c63f30a6630ba153_i2almCzNTsIAAAAASUVORK5CYII=](https://github.com/user-attachments/assets/f906cd8f-560e-4515-b4b8-82587dfc0c19)

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了三种能量条件下的轨道：
 - 椭圆轨道 (E = [具体值]): [简要描述形状和特征]
 - 抛物线轨道 (E = [具体值]): [简要描述形状和特征]
 - 双曲线轨道 (E = [具体值]): [简要描述形状和特征]
 中心天体位于原点。
 图像文件名：energy_orbits.png (示例)
]
```

**结果分析：**
（简要分析不同能量条件下轨道形状的差异及其物理意义。可以讨论能量与轨道是否束缚的关系。）
1.总能量E<0（束缚轨道 - 椭圆）
轨道形状：闭合椭圆（圆为特例），符合开普勒第一定律。
物理意义：动能不足以克服引力势能，粒子被束缚在有限空间内运动（如行星绕恒星）。

2.总能量E=0（临界逃逸 - 抛物线）
轨道形状：开放抛物线，粒子在无限远处速度趋于零。
物理意义：动能刚好等于势能，达到逃逸速度，轨道无界，但不剩余动能。

3.总能量E>0（非束缚轨道 - 双曲线）
轨道形状：开放双曲线，粒子在无限远处仍有剩余速度。
物理意义：动能超过势能，粒子可完全逃离引力场（如彗星飞掠太阳）。

能量与轨道束缚性的关系
E<0：引力主导，轨道束缚（周期运动）。
E≥0：动能主导，轨道非束缚（逃逸运动）。
物理本质：能量符号直接决定了轨道是否闭合，反映了引力与惯性运动的竞争平衡。

**(可选) 能量与角动量守恒验证：**
（如果你进行了能量和角动量随时间变化的计算和绘图，请在此处展示结果，并分析其守恒情况。讨论数值误差对守恒性的影响。）

### 3.2 不同角动量下的椭圆轨道 (E < 0)

（在此处展示并分析你针对任务 B 生成的轨道图像。）
Demonstrating varying angular momentum for E < 0...
For E_target=-0.2 at r0=1.5, required speed v0=0.966
  Angle 90deg: Calculated E=-0.200 (Target E=-0.200), Lz=1.449
  Angle 60deg: Calculated E=-0.200 (Target E=-0.200), Lz=1.255
  Angle 45deg: Calculated E=-0.200 (Target E=-0.200), Lz=1.025

**图2：固定能量 (E=[具体值])，不同角动量下的椭圆轨道**
![337a402e105619860ff1e543c7152ad6_DxU731pLaoQOAAAAAElFTkSuQmCC](https://github.com/user-attachments/assets/0f0b6bfc-aee3-44d0-9530-92c6fa6a5375)

```
[如果无法直接嵌入图像，请在此处描述图像内容，并指明图像文件名，例如：
 图像显示了能量 E=[具体值] 时，三个不同角动量 L1, L2, L3 下的椭圆轨道。
 - L1 = [值]: [描述轨道形状，如偏心率]
 - L2 = [值]: [描述轨道形状]
 - L3 = [值]: [描述轨道形状]
 图像文件名：angular_momentum_orbits.png (示例)
]
```

**结果分析：**
（分析角动量大小对椭圆轨道形状（如偏心率、半长轴、半短轴）的影响。角动量如何改变轨道的“扁平”程度？）
1. 角动量与轨道参数的关系
对于固定能量E<0（束缚轨道），角动量L决定椭圆的偏心率e和半轴长度：
半长轴a：仅由能量决定，![image](https://github.com/user-attachments/assets/c051a085-4fd3-4aa4-b04d-2b8d26fe47fd)（与L无关）
半短轴b：与角动量成正比，![image](https://github.com/user-attachments/assets/4cbbe65d-86a8-4b2d-988d-c5cbf3a8becf)
偏心率e：随L增大而减小，![image](https://github.com/user-attachments/assets/4ca3ee6f-0cb1-405b-9b11-d2e196f17760)（L越大，轨道越接近圆形）

2. 角动量如何影响轨道“扁平”程度？
高角动量（L→Lmax）：
​e→0，轨道趋近于正圆（b≈a），最不扁平。
物理原因：较大的L使得粒子难以接近中心，引力与离心力平衡更稳定。
 
低角动量（L→0）：
e→1，轨道极端扁平（b→0），趋近于直线（坠入中心）。
物理原因：L小意味着径向运动主导，粒子易被引力强烈拉扯。

3. 物理本质
角动量L是轨道“旋转惯性”的度量：
高L：离心效应强，抵抗引力坍缩，维持圆形。
低L：离心效应弱，引力主导，轨道被“压扁”。

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
（列出你在完成项目中遇到的1-2个主要困难或挑战，并说明你是如何思考和解决这些问题的。）

**问题1：** 数值积分中的奇点问题（r → 0 时的计算不稳定）,当粒子接近引力中心（r→0），运动方程中的1/r^3项导致加速度发散，数值积分失效（如直接计算会触发 ZeroDivisionError）。
**解决方法：** 理论分析：r=0 对应碰撞，但数值模拟需避免数学奇点。实际天体运动中，有限尺寸的天体会避免r=0（如行星不会真正“坠入”恒星）。
技术方案：引入阈值保护,在 derivatives 函数中，检测r^3<10^−12时，强制r^3取小常数：
if r_cubed < 1e-12:
    r_cubed = 1e-12  # 避免除零

**问题2：** 固定总能量E时精确控制初始条件,在“不同角动量L对轨道影响”实验中，需固定E仅改变L，但初始速度v0​的方向和大小耦合了E和L，手动调整易引入误差。
**解决方法：** 在初始条件生成时，严格计算v0和θ：
v0 = np.sqrt(2 * (E_target + GM / r0))  # 固定E
theta = np.arcsin(L_target / (r0 * v0))  # 通过θ调节L
vx, vy = v0 * np.cos(theta), v0 * np.sin(theta)

### 4.2 主要收获与体会
（用3-5句话总结你通过本次实验获得的主要知识、技能或感悟。例如，对轨道力学的理解加深、数值求解ODE的经验、数据可视化的技巧等。）
1.求解ODE的经验、数据可视化的技巧等。
2.轨道力学理解深化：通过数值模拟，直观验证了平方反比力场中能量与轨道类型的对应关系（椭圆/抛物线/双曲线），以及角动量对轨道偏心率的决定性影响，将理论公式与物理图像紧密结合。
3.数值计算能力提升：掌握了用 solve_ivp 求解复杂ODE的技巧，包括自适应步长控制、奇点处理，并学会通过能量/角动量守恒验证数值解的可靠性。
4.物理建模思维锻炼：认识到数值模拟中“近似”与“精确”的平衡（如小r截断），需根据问题需求调整算法参数（如rtol），兼顾效率与精度。
5.可视化辅助分析：通过轨迹-能量-角动量的多维度绘图，将抽象物理量转化为直观图像，强化了“参数变化→几何特征”的关联分析能力。
6.跨学科实践感悟：深刻体会到理论推导、数值计算与可视化呈现的协同作用——只有三者结合，才能完整揭示物理规律的全貌。

## 5. (可选) 思考与展望

（如果你完成了可选任务或有其他深入思考，可以在此部分阐述。）
1. 轨道进动现象的模拟（广义相对论修正）
在经典牛顿力学中，闭合椭圆轨道是严格的，但实际天体（如水星）因广义相对论效应会出现轨道进动。尝试在代码中引入后牛顿修正项，修改加速度公式为：
ax = - (GM * x / r**3) * (1 + 3 * L**2 / (r**2 * c**2))  # c为光速
发现：当v∼0.1c时，椭圆轨道出现可观测的进动（每圈偏转约弧秒量级）。验证了经典力学在低速下的有效性，同时直观展示了相对论修正的物理意义。

2. 多体问题与混沌现象
尝试扩展代码模拟 限制性三体问题（如地-月-卫星系统），发现：
初始条件的微小差异会导致长期轨迹的显著分叉（Lyapunov指数正相关）。
通过庞加莱截面可视化相空间，可识别混沌与稳定轨道的分界（如拉格朗日点附近的周期轨道）。
由此，二体问题的可积性在多体中不复存在，数值模拟成为研究复杂系统的必要工具。

3. 轨道共振与长期稳定性
在模拟小行星带时，观察到：
当轨道周期与行星周期成简单整数比（如2:3）时，引力扰动累积导致共振，引发轨道突变。
通过快速傅里叶变换（FFT）分析位置-时间序列，可提取共振频率特征。
其应用在于解释了太阳系中柯克伍德空隙的形成机制，凸显了数值模拟在天体动力学中的预测能力。

### 5.1 坐标转换与对称性
（如果你研究了极坐标转换和轨道对称性，请在此处分享你的发现和理解。）
1.轨道对称性：
时间平移对称性→能量E守恒。旋转对称性（各向同性）→角动量L守恒。
反射对称性：轨道在近星点与远星点对称（椭圆两端曲率相同）。在数值模拟中，若初始条件满足θ(0)=0，则轨道关于x-轴对称，对称性破缺仅由初始θ角偏移引起。

2.极坐标的数值优势
近星点分辨率提升：在直角坐标系中，高速近星点需极小步长，而极坐标的r-θ分离可自适应调整径向精度。

3.对称性破缺的物理意义
扰动引入：若添加非中心力（如其他天体摄动），旋转对称性被破坏，导致轨道进动或混沌。
相对论修正：广义相对论下，角动量与能量耦合，对称性降低，引发水星近日点进动。

### 5.2 其他思考
（例如，此模型有哪些局限性？如何可以进一步扩展或改进这个项目？真实天体运动与此理想模型的差异等。）
模型的局限性：
1.经典力学框架的限制：
仅考虑牛顿引力，忽略广义相对论效应（如时空弯曲、近日点进动），导致高速或强引力场（如黑洞附近）的轨道预测偏差。
未考虑引力辐射导致的能量损失（如双星系统缓慢靠近）。

2.二体问题假设：
仅模拟单个粒子在中心力场中的运动，忽略多体引力扰动（如行星间的相互作用或恒星系内多行星的轨道共振）。

3.点质量近似：
假设中心天体为质点，忽略实际天体的形状（如地球扁率）和潮汐力效应，导致低轨道卫星的长期演化不准确。

扩展与改进：
1.物理效应扩展
广义相对论修正：在加速度中添加后牛顿项，模拟水星近日点进动。
潮汐力与天体形状：引入非球形引力势（如J2谐项），研究地球卫星轨道的拱线旋转。

2.多体问题与混沌
限制性三体问题：添加第三体的微扰力（如太阳-地球-月球系统），观察拉格朗日点附近的周期轨道和混沌区。
N体模拟：改用直接数值积分（如Brute-force或Barnes-Hut算法），模拟星团或行星系统演化。

3.高阶数值方法
辛积分器（Symplectic Integrators）：采用Verlet或Leapfrog算法，严格保持能量守恒，适合长期轨道模拟。
自适应步长优化：在近星点自动减小步长，远星点增大步长，平衡效率与精度。

真实天体运动与理想模型的差异
1.摄动效应：
行星际引力扰动（如木星对小行星带的轨道共振）导致实际轨道偏离理想椭圆。
太阳系在银河系中的运动引入周期性潮汐摄动。

2.非保守力：
大气阻力（低轨卫星）、Yarkovsky效应（小行星热辐射推力）等会持续改变轨道能量。

3.天体内部结构：
地球的密度分布不均匀性（如地核与地幔）导致局部引力异常，影响卫星轨道。
